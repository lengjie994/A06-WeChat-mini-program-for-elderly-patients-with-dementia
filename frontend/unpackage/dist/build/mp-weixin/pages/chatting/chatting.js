(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/chatting/chatting"],{"0c54":function(t,i,e){"use strict";(function(t,o){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n={data:function(){return{openid:"",identity:"",opposite_id:"",chatlist:[],userName:"",inputValue:"",scrollTop:0,infoList:null,showMore:!1,padding_height:"0rpx",opposite_nickname:"",timer:""}},components:{fuiIcon:function(){Promise.all([e.e("common/vendor"),e.e("node-modules/firstui-uni/firstui/fui-icon/fui-icon")]).then(function(){return resolve(e("a7f0"))}.bind(null,e)).catch(e.oe)}},onShow:function(){this.getlishiList(),this.timer=setInterval(this.getlishiList,2e3),console.log(this.opposite_id)},onHide:function(){clearInterval(this.timer)},onLoad:function(t){this.openid=getApp().globalData.global_openid,this.identity=getApp().globalData.global_identity,this.opposite_id=getApp().globalData.global_opposite_id,this.opposite_nickname=getApp().globalData.global_opposite_nickname,console.log(this.identity),console.log(this.opposite_nickname),console.log(this.opposite_id)},onPageScroll:function(t){0==t.scrollTop&&(this.page++,console.log("到顶部了"),this.getlishiList(1))},beforeDestroy:function(){},methods:{changeMode:function(){this.showMore=!this.showMore,this.showMore?this.padding_height="200rpx":this.padding_height="0rpx",console.log(this.showMore)},gotoHealthdata:function(){t.navigateTo({url:"/pages/patient_healthdata/patient_healthdata?identity=doctor"})},gotoReservation:function(){t.navigateTo({url:"/pages/guardian_reservation/guardian_reservation"})},getlishiList:function(t){var i=this;o.request({url:getApp().globalData.base_url+"/ReturnChatList/",method:"POST",data:{openid:this.openid,identity:this.identity,opposite_id:this.opposite_id},success:function(t){i.chatlist=t.data.chatlist,null==i.chatlist&&(i.chatlist=[]),console.log(t),console.log("获取聊天记录成功"),i.setPageScrollTo()},fail:function(t){console.log("获取聊天记录失败")}})},setPageScrollTo:function(i,e){var n=this;this.$nextTick((function(){var i=t.createSelectorQuery().in(n);i.select("#box").boundingClientRect((function(t){var i=t.height;console.log("聊天信息框高度: ",i),o.pageScrollTo({scrollTop:i,duration:100})})).exec()}))},sendOut:function(){this.chatlist.push({msn:this.inputValue,identity:this.identity}),o.request({url:getApp().globalData.base_url+"/SaveChatlist/",method:"POST",data:{openid:this.openid,identity:this.identity,chatlist:this.chatlist,opposite_id:this.opposite_id},success:function(){console.log("发送聊天记录成功")},fail:function(t){console.log("发送聊天记录失败")}}),this.inputValue="",this.setPageScrollTo(),console.log("发送成功",this.inputValue)}}};i.default=n}).call(this,e("543d")["default"],e("bc2e")["default"])},"34d0":function(t,i,e){"use strict";(function(t,i){var o=e("4ea4");e("a1e5");o(e("66fd"));var n=o(e("407e"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(n.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])},"407e":function(t,i,e){"use strict";e.r(i);var o=e("6fde"),n=e("64e6");for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);e("f708");var s=e("f0c5"),l=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"f166fcec",null,!1,o["a"],void 0);i["default"]=l.exports},"64e6":function(t,i,e){"use strict";e.r(i);var o=e("0c54"),n=e.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return o[t]}))}(a);i["default"]=n.a},"6fde":function(t,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return n})),e.d(i,"a",(function(){}));var o=function(){var t=this.$createElement;this._self._c},n=[]},eb8e:function(t,i,e){},f708:function(t,i,e){"use strict";var o=e("eb8e"),n=e.n(o);n.a}},[["34d0","common/runtime","common/vendor"]]]);